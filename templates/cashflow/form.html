{% extends "base.html" %}

{% block title %}
  {% if mode == "create" %}
    Новая запись
  {% else %}
    Редактирование
  {% endif %}
{% endblock %}

{% block body %}
<h1>
  {% if mode == "create" %}Новая запись{% else %}Редактирование{% endif %}
</h1>

{% if error %}
  <div class="error">{{ error }}</div>
{% endif %}

<form method="post" class="row" style="flex-direction:column; align-items:flex-start;">
  {% csrf_token %}

  <label>Дата:
    <input type="date" name="date"
           {% if item %}value="{{ item.date|date:'Y-m-d' }}"{% endif %}>
  </label>

  <label>Тип:
    <select name="type">
      {% for x in types %}
        <option value="{{ x.id }}"{% if item and item.type_id == x.id %} selected{% endif %}>
          {{ x.name }}
        </option>
      {% endfor %}
    </select>
  </label>

  <label>Статус:
    <select name="status">
      {% for x in statuses %}
        <option value="{{ x.id }}"{% if item and item.status_id == x.id %} selected{% endif %}>
          {{ x.name }}
        </option>
      {% endfor %}
    </select>
  </label>

  <label>Категория:
    <select name="category">
      {% for x in categories %}
        <option value="{{ x.id }}"{% if item and item.category_id == x.id %} selected{% endif %}>
          {{ x.name }} ({{ x.type.name }})
        </option>
      {% endfor %}
    </select>
  </label>

  <label>Подкатегория:
    <select name="subcategory">
      <option value="">—</option>
      {% for x in subcategories %}
        <option value="{{ x.id }}"{% if item and item.subcategory_id == x.id %} selected{% endif %}>
          {{ x.name }} ({{ x.category.name }})
        </option>
      {% endfor %}
    </select>
  </label>

  <label>Сумма:
    <input type="number" step="0.01" name="amount"
           {% if item %}value="{{ item.amount }}"{% endif %}>
  </label>

  <label>Комментарий:
    <input type="text" name="comment"
           {% if item %}value="{{ item.comment }}"{% endif %}>
  </label>

  <div class="row">
    <button type="submit">Сохранить</button>
    <a href="{% url 'cashflow_list' %}">Отмена</a>
  </div>
</form>
{% endblock %}
